Class Race:
  def __init__(self, track, laps=3):
    self.track = track #об'єкт класу трек
    self.laps = laps #к-ть кіл 
    self.cars = [] #список машин
    self.drivers = [] #список водіїв
    self.results = {} #результати

  def addParticipant(self, driver, car): #додає машину і водія
    self.drivers.append(driver)
    self.cars.append(car)

  def startRace(self): #починає симуляцію гонки
    for lap in range(1, self.laps + 1):
      self.simulateLap(lap)

  def simulateLap(self, lapIndex):
    for i, car in enumerate(self.cars):
      driver = self.drivers[i]
      section_speed = car.speed * self.track.getSectionSpeedFactor(lapIndex)
      section_time = self.track.length / section_speed
      if driver.name not in self.results:
        self.results[driver.name] = 0
      self.results[driver.name] += section_time

  def sortedResults(self):
    return sorted(self.results.items(), key=lambda x: x[1])

  def saveResults(self, filename):
    with open(filename, "w", encoding="utf-8") as f:
      f.write("Результати гонки:\n")
      sorted_results = self.sortedResults()
      for place, (name, total_time) in enumerate(sorted_results, start=1):
        f.write(f"{place}. {name}: {total_time:.2f} с\n")
